---
layout: default
---

<body>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<center> <h1> Eating All The Chocolates </h1> </center>
<center> <h3> 10/03/2020 </h3> </center>

<h2> Problem Statement </h2> 
<h3>
<p>
The eating chocolate problem stated <a href = "https://fivethirtyeight.com/features/can-you-eat-all-the-chocolates//" target = "blank"> here </a> asks:
</p>

<blockquote>
I have 10 chocolates in a bag: Two are milk chocolate, while the other eight are dark chocolate. One at a time, I randomly pull chocolates from the bag and eat them — that is, until I pick a chocolate of the other kind. When I get to the other type of chocolate, I put it back in the bag and start drawing again with the remaining chocolates. I keep going until I have eaten all 10 chocolates.

For example, if I first pull out a dark chocolate, I will eat it. (I’ll always eat the first chocolate I pull out.) If I pull out a second dark chocolate, I will eat that as well. If the third one is milk chocolate, I will not eat it (yet), and instead place it back in the bag. Then I will start again, eating the first chocolate I pull out.

What are the chances that the last chocolate I eat is milk chocolate?
</blockquote>

The answer is <b>0.0222</b>, or <b>02.22%</b>.


<h2> Motivating Example </h2>
<h3>

<p>
Under the rules of the game, the only condition under which the last chocolate you eat is milk chocolate is when the first 8 chocolates you eat are dark chocolate. In other words, the only condition when you would eat the milk chocolate last is when the first milk chocolate is drawn 9th then leaving the final milk chocolate to be pulled in sequence in position 10.

So, another way to consider the game is what are the chances that the first 8 draws from the bag will result in a dark chocolate?
</p>

<p>
So, at draw 1, the chances of pulling a dark chocolate out of the bag is \(\frac{8}{10}\). You always eat the first chocolate and assuming the first one pulled is dark chocolate, there are now 7 remaining dark chocolates and 9 total remaining chocolates. So, at draw 2 the probability of pulling another dark chocolate is \(\frac{7}{9}\). 
</p>
</h3>

<h2> Towards a Solution </h2>
<h3>
<p>
Under the assumption we pull a dark chocolate first and continue to do so for the first 8 draws, then the probability of repeating that sequence can be expressed as:
</p>

$$
Pr(x) = \left(\frac{8}{10}\right) \times \left(\frac{7}{9}\right) \times \left(\frac{6}{8}\right) \times \left(\frac{5}{7}\right) \times\left(\frac{4}{6}\right) \times\left(\frac{3}{5}\right) \times\left(\frac{2}{4}\right) \times\left(\frac{1}{3}\right)  = .0222
$$

<p>
More generally, we can let the total number of chocolates be written as \(N = N_{d} + N_{m}\) where \(N_{d}\) denotes dark chocolate and \(N_{m}\) denotes milk chocolate. Then, the probability is:  
</p>

$$
\begin{split}
P(x) &= \frac{N_{d}!}{\prod_{i=N_{m}+1}^N i}\\
&= \frac{N_d!\times N_m!}{N!}\\
\end{split}
$$

factorial(N.d)*factorial(N.m)/factorial(N)

</h3>

<p>
We can test the using a little simulation. The R code below counts the proportion of times that a milk chocolate (type 2) is drawn in positions 9 and 10.
</p>


> prod(3:10)
[1] 1814400
> factorial(10)/factorial(2)
[1] 1814400

N = 10
N.m = 2
N.d = N-N.m

factorial(N.d)/prod((N.m+1):N)
factorial(N.d)*factorial((N.m))/factorial(N)

<pre>
<code>
### Simulate a bag of chocolates 
cc <- c(1,1,1,1,1,1,1,1,2,2)
### Take random draws from this bag K times
K <- 1000000
rr <- numeric(K)
for (i in 1:K){
	x <- sample(cc,10)
	rr[i] <- all(x[9:10]==2)
}
mean(rr)
[1] 0.022339

### Using general expression
factorial(8)/prod(3:10)
[1] 0.02222222
</pre>
</code>



<hr>

<center> <h1> Shooting Par </h1> </center>
<center> <h3> 09/26/2020 </h3> </center>

<p>
Errata (9/28/2020). The solution below fails to convert either \(L_0\) to inches or \(L_4\) to yards. So, either set \(L_0\) = 14,400 or set \(L_4\) = 0.059027778. Then, the proposed solution stands. 
</p>

<h2> Problem Statement </h2> 
<h3>
<p>
The shooting par golf problem stated <a href = "https://fivethirtyeight.com/features/can-you-save-some-cold-pizza/" target = "blank"> here </a> asks:
</p>

<blockquote>
A typical hole is about 400 yards long, while the cup measures a mere 4.25 inches in diameter. Suppose that, with every swing, you hit the ball X percent closer to the center of the hole. For example, if X were 75 percent, then with every swing the ball would be four times closer to the hole than it was previously.

For a 400-yard hole, assuming there are no hazards (water, sand or otherwise) in the way, what is the minimum value of X so that you’ll shoot par, meaning you’ll hit the ball into the cup in exactly four strokes?
</blockquote>

<b> The answer is \(73.00243\%\)</b> with solution below and a little <a href = "#golf_plot"> interactive visual display </a> showing where the ball would land at the fourth hit under different percentages.
</h3>

<h2> Motivating Example </h2>
<h3>

<p>
Conceptually, we need to set something up along the lines of the following. At the tee, I'm 400 yards away, or at the initial location, \(L_0\) = 400. From initial position, \(L_0\), I take my first swing and move the ball to the new location, \(L_1\), moving \(p\%\) closer to the destination. Now from \(L_1\) I take a second hit and land at position \(L_2\) by again moving the ball by the same percent. Repeat by hitting \(p\%\) closer to the hole each time until hit four puts me right at the edge of the hole on my side of the tee. 
</p>

<p>
Since the diameter of the hole is 4.25, we can assume the ball falls into the cup once it reaches the outer edge of the cup, or is 2.125 inches from the center of the hole. Technically, we might assume the location of the final hit is represented as an inequality, \(\leq 2.125\). But, for convenience, I'll assume landing at exactly 2.125 results in a gravitional pull towards the center of the cup. 
</p>

<p>
Let \(L_i\) be the location of the ball after hit \(i = \{1,2,3,4\}\) then we need to move the ball from \(L_0\) to \(L_4\) in exactly four swings and each hit moves the ball \(p\%\) closer such that:

$$
p = 1- \frac{L_i}{L_{i-1}}, \ \forall \ i
$$ 
</p>

where \(p\% = 100 \times p\).

<h2> Towards a Solution </h2>
<h3>

<p>
I set this up to find the best value for \(x\), then \(p = 1-x\). Start by writing the four hits as the following system of equations: 

$$
\begin{split}
L_0 \times x &= L_1\\
L_1 \times x &= L_2\\
L_2 \times x &= L_3\\
L_3 \times x &= L_4\\
\end{split}
$$
</p>

<p>
We know that \(L_0\) = 400 and \(L_4\) = 2.125, then use the <a href = "https://en.wikipedia.org/wiki/System_of_linear_equations#Elementary_examples", target = "blank"> method of substitution </a> to solve for the single unknown, \(x\), in the system above resulting in:

$$
\begin{split}
400 \times x^4 &= 2.125\\
x^4 &= \frac{2.125}{400}\\
x &= \left(\frac{2.125}{400}\right)^{1/4}\\
x &= 0.2699757
\end{split}
$$

So hitting \(73.00243\%\) (i.e., \((1-0.2699757)\times100\)) closer to the hole each time puts me within the expected radius of the hole. 
</p>

<p>
Let's plug in the value and see what would happen at each hit. Start at 400 yards away and then hitting \(73.00243\%\) closer to the hole puts me at location \(L_1 = 107.9903\). From this new point, I hit \(73.00243\%\) closer again and end up at location \(L_2 = 29.15476\). From location \(L_2\) I again shorten the distance to the hole by \(73.00243\%\) and end up at location \(L_3 = 7.871077\). Finally, with my fourth and final hit I again shorten the distance between \(L_3\) and the hole by \(73.00243\%\) and end up at \(L_4\)=2.124999.
</h3>
</p>

<h2> A Visualization </h2>
<h3>

<p>
The Python code helps with a brute force sense of the best value for \(p\) by examining the interactive visual and finding where the value for \(p\) approximately first intersects with the edge of the cup, or at about 2.125 at location \(L_4\). <a href = "https://plotly.com/" target = "blank"> Plotly </a> is great because you can interact with the visual and zoom into regions closer to "find" the best value (or see <a href ="https://hdoran.github.io/Blog/golf_plot.html" target = "blank"> this visual </a> in its own tab. 
</p>

<p>
To see where the ball would land on the fourth hit for different percentages, hover over the blue line until it intersects with the green line (which represents the edge of the cup at point 2.125) and we see they seemingly first intersect right around \(73\%\). 
</p>

<pre>
<code>
import plotly.express as px
import numpy as np
p = np.arange(0,1,.0001)	 
result = 400*p**4
fig =px.scatter(x=1-p, y=result)
fig.update_layout(title='Brute Force Search Over Various Values of P%',
	xaxis_title='Value for P',
	yaxis_title='Ball Location at L_4')
fig.add_shape(
	# Line Horizontal
		type="line",
		x0=0,
		y0=2.125,
		x1=1,
		y1=2.125,
		line=dict(
			color="Green",
			width=4,
		),
)
fig.update_shapes(dict(xref='x', yref='y'))	
fig.show()
</code>
</pre>

<div id = "golf_plot">
<iframe id="igraph" scrolling="no" style="border:none;" seamless="seamless" src="golf_plot.html" height="500" width="100%"></iframe>
</div>
</h3>

<hr>
<center> <h1> Dictionary Problem </h1> </center>

<h2> Problem Statement </h2> 
<h3>
<p>
The dictionary problem as stated <a href = "https://fivethirtyeight.com/features/can-you-break-a-very-expensive-centrifuge/" target = "blank"> here </a> is summarized as:

"Each secret word is randomly chosen from a dictionary with exactly 267,751 entries. If you have this dictionary memorized, and play the game as efficiently as possible, how many guesses should you expect to make to guess the secret word?" <b> The answer is 17.04 with a maximum number of required guesses being 19. </b>
</p>
</h3>

<h2> Motivating Example </h2>
<h3>
<p>
The solution is motivated by a simple example using a <a href = "https://en.wikipedia.org/wiki/Binary_search_algorithm" target="_blank"> binary search algorithm </a> to consider how we might work efficiently. To illustrate, I pick a random number from 1 to 15 and ask you to guess the number I am thinking. I will tell you if it's higher, lower, or correct. You first guess the midpoint, 8, which has a \(\frac{1}{15}\) chance of being correct. If the number is higher you can eliminate numbers 1 to 8 (or vice versa if the number is lower) and guess two has a \(\frac{1}{7}\) chance of being correct by focusing on the new region of the sequence (i.e., numbers 9 through 15). If a guess 3 is needed, find the midpoint in the remaining sequence and the success probability becomes \(\frac{1}{3}\). Last, guess 4 (if needed) has only one remaining possible choice, hence the success probability at this point is 1. Using this strategy with a sequence of size 15, you would need a maximum of 4 attempts to identify the number with certainty.
</p>

<p>
So, by iteratively halving the sequence and reducing the search space in the region where the number exists, we continue to improve the probability of success until we ultimately reach a point of certainty. This illustrates a way to work efficiently and a model for estimating the maximum number of guesses we would need to find a solution. However, we won't always need the maximum number of guesses as other values less than the maximum have non-zero probabilities, but this helps conceptualize the problem to work towards a solution for the expected value.
</p>

<p>
Combining these pieces of information, we can find the expected value for the number of guesses, \(E(G)\), by using the probabilities of being right or wrong at each possible guess, 1 through the maximum. In this example, we can write:

$$
E(G) = 1 \cdot \frac{1}{15} + 2 \cdot \frac{14}{15}\frac{1}{7} + 3 \cdot \frac{14}{15}\frac{6}{7}\frac{1}{3} + 4 \cdot \frac{14}{15}\frac{6}{7}\frac{2}{3}1 = 3.266
$$

This example shows that piecing this together requires knowing:
<ul>
	<li> The maximum number of guesses needed
	<li> The probability of being right at each guess
	<li> The accumulated probabilities of being wrong for all guesses prior to the \(n\)th guess
</ul>
</p>

To establish a little notation for the preceding example, let \(\Pr(x=1|g_n)\) denote the success probability at the \(n\)th guess and let \(\Pr(x=0|g_n)\) denote the probability of being wrong at the \(n\)th guess. Then the expected value for the number of guesses in this example can be written as:

$$
\begin{split}
E(G) & = 1 \cdot \Pr(x=1|g_1) \\ 
	& +  2 \cdot \Pr(x=0|g_1)\Pr(x=1|g_2) \\  
	& + 3 \cdot \Pr(x=0|g_1)\Pr(x=0|g_2)\Pr(x=1|g_3) \\ 
	& + 4 \cdot \Pr(x=0|g_1)\Pr(x=0|g_2)\Pr(x=0|g_3)\Pr(x=1|g_4)
\end{split}
$$

<h2> Towards a Solution </h2>
<h3>

<p>
Knowing that our success probability tends to 1 using this strategy, finding a general solution requires building a model that makes use of this efficient strategy. For completeness, first find the maximum number of times a sequence of size \(k\) can be halved: 

$$
L = \textrm{floor}\left(\frac{\log(k)}{\log(2)}\right)
$$ 

and then generally the maximum number of guesses needed to locate the correct answer in a sequence of size \(k\) is \(N = 1 + L\), or initial guess plus remaining number of times the sequence can be halved. Then, generalizing to find the expected value over an arbitrary sequence of length \(k\):

$$
E(G) = \Pr(x=1|g_1) + \sum_{n=2}^N \left(n \cdot \Pr(x=1|g_n) \prod_{j \in a}\Pr(x=0|g_j)\right)
$$

where the notation \(j \in a\) is used to mean the accumulated set of incorrect probabilities preceding the \(n\)th guess which can be computed by recursion.

</p>

<p>
Applying this to the dictionary problem with a dictionary consisting of 267,751 words yields an expected <b> maximum </b> number of guesses:

$$
\textrm{floor}\left(\frac{\log(267751)}{\log(2)}\right) + 1 = 19.
$$ 
</p>

<p>
However, guessing the secret word could happen in fewer than 19 guesses. We can apply the expression above to find \(E(G) = 17.04\). Additionally, we can simulate the problem using a binary search algorithm over multiple replications of the problem and find the expected value of 17.04 via simulation. The result would give an empirical distribution for the number of guesses needed to find the secret word as:
</p>

<center>
<img src="Images/hist.jpg">
</center>

<p>
Below is R code implementing the binary search and repeating that process to find the expected value for the number of guesses.
</p>

<pre>
<code>
### Function to implement binary search
### k = secret number
### s = ordered sequence
### Function searches for secret number
### and reports number of iterations to find
binSearch <- function(k, s){ 
	s <- 1:s
	counter <- 1
		while(length(s) > 1){
			mid <- floor(median(s))
			if (k == mid){
			s <- k
			} else if (k < mid){
			s <- min(s):(mid-1)
			counter <- counter + 1
			} else {
			s <- (mid+1):max(s)
			counter <- counter + 1
		}
	}
	list("Value Found" = s, "Number of Iterations" = counter)
}

### Iterate over binSearch function 200,000 times to find expected value
k <- 200000
result <- numeric(k)
L <- 267751
for(i in 1:k){
	x <- sample(1:L,1)
	result[i] <- as.numeric(binSearch(x,L)[2][1])
}
mean(result)
</code>
</pre>

</h3>

<hr>
<center> <h1> Basketball Problem </h1> </center>

<h2> Problem Statement </h2>
<h3>
<p>
The basketball problem as stated <a href = "https://fivethirtyeight.com/features/can-you-reach-the-summit-first/" target = "blank"> here </a> is summarized as, "What is the probability that, on any given week, it’s possible to form two equal teams with everyone playing, where two towns are pitted against the third?"
</p>

<p>
<b> The general answer is \(\left(\frac{1}{N}\right)^3 \left[\frac{(N-1)^2 + (N-1)}{2}\right] \times 3\) where \(N\) is the number of individuals that show up from each of the three towns randomly. Then, the case with 5 players is a special case of this such that \(\left(\frac{1}{5}\right)^3 \left[\frac{(5-1)^2 + (5-1)}{2}\right] \times 3 = .24\). </b>
</p>
</h3>

<h2> Motivating Example </h2>
<h3>
<p>
It's easy to see the concept when N = 5 because the number of equal team combinations is small. In this example, we observe 30 possible ways in which equal teams could be created. For example, if 2 members show up from town \(x_1\), then we must have 1 from town \(x_2\) and 1 from town \(x_3\) (there is no option where 0 members show up from any town). So, write this as 2;1-1 as notation to mean that 2 members arrive from town \(x_1\) and then the equal team is created when 1 member arrives from town \(x_2\) and 1 more from town \(x_3\). Then, the other possible patterns in this example are 3;1-2, 3;2-1, 4;1-3, 4;2-2, 4;3-1, 5;1-4, 5;2-3, 5;3-2, and 5;4-1.
</p>
</h3>

<h2> Towards a Solution </h2>
<h3>

<p>
The motivating example shows a total of \(\frac{(N-1)^2 + (N-1)}{2}\) unique combinations for equal teams where town \(x_1\) is pitted against towns \(x_2\) and \(x_3\). But, since this can be arranged such that any town is the third town, we actually have \(\frac{(N-1)^2 + (N-1)}{2} \times 3\) possible equal team combinations.

Since we also assume each outcome is equally as likely (i.e., any number from 1 to 5 might show up), we have a probability of \(p = \left(\frac{1}{N}\right)^3\) to observe this outcome for each of the possible combinations to make equal teams. So in words, it's the probability of the outcome times the number of times an "equal teams" outcome can occur with \(N\) players from 3 towns.
</p>

<p>
We can "check" the analytic expression with a simulation. Some R code to run a simulation over \(K\) replications of the problem where \(N\) is the upper limit on the number of players that might arrive from any given town.
</p>
</h3>

<code>
### MC Answer<br>
K <- 1000000 <br>
N <- 5 # Change this to be any number of max players<br>
team1 <- sample(N,K, replace = TRUE)<br>
team2 <- sample(N,K, replace = TRUE)<br>
team3 <- sample(N,K, replace = TRUE)<br>
full <- as.data.frame(cbind(team1, team2, team3))<br>
indx <- apply(full, 1, function(x) which.max(x))<br>
result <- sapply(1:K, function(i) sum(full[i, -indx[i]]) == full[i,indx[i]])<br>
table(result)[2]/K<br>
### Analytic<br>
(1/N)^3 * ((N-1)^2 + (N-1))/2 * 3<br>
</code>

<hr>
<center> <h1> The Broken Ruler Problem </h1> </center>

<h2> Problem Statement </h2>
<h3>
<p>
The broken ruler problem as stated <a href = "https://fivethirtyeight.com/features/are-you-hip-enough-to-be-square/" target = "blank"> here </a> asks, "Recently, there was an issue with the production of foot-long rulers. It seems that each ruler was accidentally sliced at three random points along the ruler, resulting in four pieces. Looking on the bright side, that means there are now four times as many rulers — they just happen to have different lengths. On average, how long are the pieces that contain the 6-inch mark?"
</p>
</h3>

<h3>
<p>
<b>The answer is 5.625.</b> This submission provides an analytic solution and additionally a simulation-based approach.
</p>
</h3>

<h2> Motivating Example </h2>
<h3>

<p>
We can conceptualize the problem easily. Think about splitting the 12 inch ruler into two equal regions--a lower region below the 6 inch mark and an upper region above the 6 inch mark. Let \(R_1\) be the lower region, \(0 \leq R_1 < 6\) and let \(R_2\) be the upper region, \(6 < R_2 \leq 12\). Let each cut, \(x_i\) for \(i = {1,2,3}\), be an ordered random variable as \(0 < x_1 < x_2 < x_3 < 12\) and further assume the cuts are independent and uniformly distributed. Then there is a 50% chance that any given cut will fall into either \(R_1\) or \(R_2\).  
</p>

<p>
There are only two ways in which a cut can occur containing the 6 inch mark. One potential outcome occurs when \(x_i\) \(\forall \ i\) fall into one and only one region. Then, the length is measured from the ruler's edge to the first ordered point. Refer to this as the "long cut" because we know it must be at least 6 inches in length.
</p>

<p>
A second way is when two cuts fall into one region and the remaining cut falls into the other. Then, the length is measured using the points where the 6 inch mark is interior to the cuts. For example, case 1 might be all points fall into \(R_1\) in which case the length is measured as \(L = 12 - x_3\). Or to illustrate case 2 we might observe two points in \(R_1\) and one point in \(R_2\). Then, the length is measured as \(L = x_3 - x_2\). Refer to this as the "short cut" because this slice can be less than 6 inches.
</p>

<p>
All cuts are latent random variables and so we cannot know values for \(x_i\)--the preceding is just conceptual and motivates towards a solution. 
</p>

</h3>

<h2> Towards a Solution </h2>
<h3>

<p>
<a href = "https://en.wikipedia.org/wiki/Order_statistic" target = "blank"> Order statistics </a> have some nicely defined (and simple) expected values that work well for this scenario that are useful for solving this problem. It is specifically useful to know that \(E(\min(x_1, \dots, x_n ))= \frac{1}{n + 1}\). Then, we can define the expected value for the "long cut" to be:

$$
6 \times (1 + E(\min(x_1,x_2,x_3)) = 6 \times (1 + 1/4) = 7.5.
$$ 

The probability that all three cuts fall above the 6" mark is \(.5^3\) = .125. Conversely, all cuts can fall below with the same probability, so long cuts will occur \(25\%\) of the time. Note, in this expectation I assume all values for \(x_i\) fall into region \(R_2\). But, the opposite (and similar) expected value can be written for when all values for \(x_i\) fall into region \(R_1\).
</p>

<p>
We can similarly define a "short cut" as:

$$
6 \times (E(\min(x_3,x_2) - E(x_1)) = 6 \times ((1 + 1/3) - 1/2) = 5.
$$

The probability of this occuring is 1 - .25 = .75 (i.e., the converse of the long cut). Note that in this expectation, I assume both \(x_2\) and \(x_3\) fall into region \(R_2\) and then \(x_1\) falls into \(R_1\). The similar and opposite can also occur.
</p>

<p>
We've now defined the universe of potential outcomes and their probability of occuring, so to find the exact answer we then simply find the expected value via the weighted mean of the two potential outcomes:

$$
\begin{split}
E(X) & = \sum_{i=1}^2p_iX_i \\
	& = .25 \times 7.5 + .75 \times 5 \\
	& = 5.625. 
\end{split}
$$

where \(X_i\) denotes the long and short cuts, respectively.
</p>


<p>
To "verify" lets explore using a simulation-based method. Take 3 random draws for \(x_i \sim U[0,12]\) and sort them by increasing value to represent the ordering of \(x_1, x_2\), and \(x_3\). These can be treated as the cut locations on the ruler occuring at three randomly placed locations between 0 and 12 giving us a simulated "broken ruler" with 4 segments.
</p>

<p>
Now, search to find which of the four resulting segments contains the 6 inch mark and measure the length of this segment as \(L = x_i - x_{i-1}\). Replicate this process \(K\) times, yielding a vector of lengths, \(L = {L_1, L_2, \ldots, L_k}\) and find the mean over the vector of simulated possible outcomes. 
</p>

<p>
The R code below implements this process for generating the data and finding the mean. If we examine the empirical distribution of all simulated outcomes, we see a "shark fin" looking distribution of potential outcomes.
</p>

<center>
<img src="Images/ruler.jpg">
</center>

<pre>
<code>
K = 10000000 #Number of replicates. Change to a lower number for speed
result <- numeric(K)
for(i in 1:K){
	### Randomly cut a ruler into 4 pieces (three random cuts)
	cuts <- c(0, sort(runif(3, 0, 12)), 12)

	### Find which piece contains 6" mark
	pos <- min(which(TRUE == (6 <= cuts)))

	### Measure length of piece containing the 6" mark
	result[i] <- cuts[pos]-cuts[(pos-1)]
}

mean(result)
5.62484
</pre>
</code>

<hr>
<center> <h1> The Short Season Baseball Problem </h1> </center>

<h2> Problem Statement </h2>
<h3>
<p>
The short season baseball problem as stated <a href = "https://fivethirtyeight.com/features/can-the-hare-beat-the-tortoise/" target = "blank"> here </a> asks: 

<blockquote>
"Some statistics are more achievable than others in a shortened season. Suppose your true batting average is .350, meaning you have a 35 percent chance of getting a hit with every at-bat. If you have four at-bats per game, what are your chances of batting at least .400 over the course of the 60-game season? And how does this compare to your chances of batting at least .400 over the course of a 162-game season?

Extra credit: Some statistics are less achievable in a shortened season. What are your chances of getting a hit in at least 56 consecutive games, tying or breaking Joe DiMaggio’s record, in a 60-game season? And how does this compare to your chances in a 162-game season? (Again, suppose your true batting average is .350 and you have four at-bats per game.)"
</blockquote>
</p>
</h3>

<h3>
<p>
<b>The answer is 0.0541855.</b> 
</p>
</h3>


<h2> Towards a Solution </h2>
<h3>

<p>
Begin with assuming each hit is an independent event so this means that the expected number of hits over 240 at bats (60 games \(\times\) 4 at bats per game) is .35 \(\times\) 240 = 84. Hitting a .400 in 240 at bats means we would observe 96 hits.
</p>

<p>
The binomial distribution gives the probability for observing independent events, but the beta distribution is the probability distribution for modeling proportions (i.e., continuous and bounded between 0 and 1). The Riddler Nation question is asking what is the probability of observing a specific proportion (e.g., chances of batting .400). So, we can easily find the shape parameters for the beta since we know the expected proportion over 240 events is .350, so then solving for \(\alpha\) and \(\beta\):

$$
.35 = \frac{\alpha}{\alpha + \beta}
$$

So then rearranging to solve for \(\alpha\): 

$$
\begin{split}
\alpha & = .35\times(\alpha + \beta)\\
 & = .35\times240\\
	&= 84 
\end{split}
$$ 

and then \(\beta\) = 240 - 84 = 156. Now, we have a continuous p.d.f. and we can find the answer by evaluating the integral over \(f(x|\alpha, \beta) \sim Beta(84,156)\) or: 

$$
\begin{split}
E(H) & = \int^1_{.4}f(x|\alpha, \beta)dx\\
	& = 0.0541855
\end{split}
$$

So, the chances are roughly about 5.4% that we would observe a batter with a true batting average of .35 hitting a .400 average in a 60 game season. Some R code to show math result:

<pre>
<code>
f <- function(x) dbeta(x, 84, 156)
integrate(f, .4,1) 
0.0541855 with absolute error < 6.7e-06
1-pbeta(.4, 84, 156)
[1] 0.0541855
</code>
</pre>
</p>

<p>
Now using the same approach, we can answer how this compares to a true .350 batter hitting a .400 in a 162 game season. Here the shape parameters \(\alpha\) = 226.8 and \(\beta\) = 421.2 (find these using 648 total at bats in 162 games with a true .350 probability). In this case the probability that we observe a .400 season is 0.004319934, or we expect roughly a .43% chance of observing a true .350 hitter batting a .400 in a 162 game season. Some more R code:

<pre>
<code>
f <- function(x) dbeta(x, 226.8, 421.2)
integrate(f, .4,1)
0.004319934 with absolute error < 4.6e-09
</code>
</pre>
</p>
 
<p>
Out of curiosity, we might be tempted to assume that we can use a gaussian normal rather than a beta. From the properties of the binomial, we have an expected mean of 84 and a standard error of  \(\sigma = \sqrt{.35\times(1-.35) \times 240)}\) = 7.389181. We could evaluate the integral over the normal from 96 to infinity, 

$$
\begin{split}
E(H) & \approx \int^{\infty}_{96}f(x|\mu, \sigma)dx\\
	& \approx 0.05218834
\end{split}
$$

where \(f(x|\mu, \sigma) \sim \mathcal{N}(\mu, \sigma)\) giving about a 5.2% chance. Note the similarities, but the normal is not the right generating distribution, although it gives a decent(ish) approximation. Some R code for that approach:

<pre>
<code>
f <- function(x) dnorm(x, 84, 7.389181)
integrate(f, 96,Inf)
</code>
</pre>
</p>

<p>
One last approach could be to use a monte carlo approach and take some random draws from the binomial and count the proportion of times we observe 96 hits (this is the .400 in 240). Let's take a lot of draws, make it 5 million. This would give us about ~6.08% chance. Some R code for math: 

<pre>
<code>
K = 5000000
x=rbinom(K, 240, .35)
length(which(x >=96))/K * 100
</code>
</pre>
</p>


</p>






</body>
